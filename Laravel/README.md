# ساختار اولیه برای فایل پرامپت‌های لاراول

<div dir="rtl">
<p align="center"><img src="../art/banner-prompt.png" alt="banner for persian laravel ai prompts"></p>

<div align="center">

[![Authors](https://img.shields.io/badge/Authors-orange.svg?style=flat-square)](#authors)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square)](http://makeapullrequest.com)
[![MIT License](https://img.shields.io/badge/License-MIT-green.svg)](https://choosealicense.com/licenses/mit/)

</div>


# پرامپت‌های لاراول برای توسعه‌دهندگان PHP 🚀

<div align="center">

مجموعه‌ای از پرامپت‌های کاربردی و دقیق برای توسعه‌دهندگان لاراول

</div>

این مجموعه شامل پرامپت‌های تخصصی برای فریم‌ورک لاراول است که با جزئیات دقیق طراحی شده‌اند تا کیفیت کد و سرعت توسعه‌ی شما را افزایش دهند. هر پرامپت به گونه‌ای نوشته شده که جنبه‌های مهم توسعه‌ی لاراول را پوشش دهد و بهترین شیوه‌ها را در نظر بگیرد.

پرامپت مناسب رو انتخاب کن، با نیازهای پروژه‌ات تطبیقش بده و از نتیجه لذت ببر! 💻✨

## 📋 فهرست مطالب

### 📊 مدل‌ها و Eloquent
- [🔗 طراحی مدل با روابط پیچیده](#طراحی-مدل-با-روابط-مختلف) - مدل‌های Eloquent با روابط چندگانه و پیشرفته بساز
- [🚀 بهینه‌سازی کوئری‌های پیچیده](#بهینه‌سازی-کوئری‌های-پیچیده) - کوئری ‌های کند رو سریع‌تر و کارآمدتر کن
- [🔍 اسکوپ‌ها و Local Scopes حرفه‌ای](#اسکوپ‌ها-و-local-scopes-حرفه‌ای) - کوئری‌های تکراری رو با اسکوپ‌های کاربردی مدیریت کن
- [🧙‍♂️ متدهای کمکی و accessor/mutator](#متدهای-کمکی-و-accessormutator) - داده‌ها رو قبل و بعد از ذخیره‌سازی پردازش کن
- [📊 گزارش‌گیری پیشرفته با Eloquent](#گزارش‌گیری-پیشرفته-با-eloquent) - کوئری‌های پیچیده برای گزارش‌های تحلیلی بساز


### 🏗️ معماری و ساختار پروژه
- [🔄 طراحی معماری سرویس‌محور](#طراحی-معماری-سرویس‌محور) - ساختار پروژه‌ات رو با معماری تمیز و اصولی طراحی کن
- [🧩 پیاده‌سازی الگوی Repository](#پیاده‌سازی-الگوی-repository) - لایه‌ی دسترسی به داده رو از منطق کسب‌وکار جدا کن
- [🏢 معماری DDD در لاراول](#معماری-ddd-در-لاراول) - پروژه‌ات رو با اصول Domain-Driven Design پیاده‌سازی کن
- [📦 ساختاربندی ماژولار](#ساختاربندی-ماژولار) - پروژه رو به ماژول‌های مستقل و قابل توسعه تقسیم کن

### 🎮 کنترلرها و روت‌ها
- [🛠️ کنترلر RESTful استاندارد](#کنترلر-restful-استاندارد) - کنترلرهای RESTful با بهترین شیوه‌های لاراول بساز
- [♻️ ریفکتور کنترلر حجیم](#ریفکتور-کنترلر-حجیم) - کنترلرهای بزرگ و پیچیده رو به کدهای تمیز و قابل نگهداری تبدیل کن
- [🔀 روت‌های پیشرفته و گروه‌بندی](#روت‌های-پیشرفته-و-گروه‌بندی) - مسیرهای برنامه رو سازماندهی و بهینه کن
- [🛂 میدل‌ور سفارشی](#میدل‌ور-سفارشی) - میدل‌ورهای کاربردی برای کنترل درخواست‌ها و پاسخ‌ها بساز
- [🎯 Form Request و اعتبارسنجی پیشرفته](#form-request-و-اعتبارسنجی-پیشرفته) - اعتبارسنجی داده‌های ورودی رو قدرتمند و منعطف کن

### 🗄️ مایگریشن و دیتابیس
- [📐 طراحی میگریشن بهینه](#طراحی-میگریشن-بهینه) - میگریشن‌های کارآمد با ساختار مناسب طراحی کن
- [🔄 سیدر و فکتوری پیشرفته](#سیدر-و-فکتوری-پیشرفته) - داده‌های آزمایشی واقع‌گرایانه برای توسعه و تست بساز
- [📈 ایندکس‌گذاری و بهینه‌سازی دیتابیس](#ایندکس‌گذاری-و-بهینه‌سازی-دیتابیس) - عملکرد دیتابیس رو با ایندکس‌های مناسب بهبود بده
- [🔄 کوئری‌های خام بهینه](#کوئری‌های-خام-بهینه) - کوئری‌های SQL پیچیده رو بهینه و ایمن کن

### 🧪 تست‌نویسی
- [✅ تست یونیت برای سرویس‌ها](#تست-یونیت-برای-سرویس‌ها) - پوشش تست کامل برای سرویس‌های برنامه ایجاد کن
- [🧩 تست فیچر برای API](#تست-فیچر-برای-api) - API‌ها رو با سناریوهای واقعی تست کن
- [🔄 تست با دیتابیس و سیدینگ](#تست-با-دیتابیس-و-سیدینگ) - تست‌های واقع‌گرایانه با داده‌های آزمایشی بنویس
- [👥 موک و فیک سرویس‌های خارجی](#موک-و-فیک-سرویس‌های-خارجی) - وابستگی‌های خارجی رو برای تست‌های ایزوله شبیه‌سازی کن

### ⚡ بهینه‌سازی و کش
- [🚀 استراتژی کش جامع](#استراتژی-کش-جامع) - سیستم کش کارآمد برای افزایش سرعت برنامه طراحی کن
- [⏱️ بهینه‌سازی عملکرد اپلیکیشن](#بهینه‌سازی-عملکرد-اپلیکیشن) - نقاط کند برنامه رو شناسایی و بهینه کن
- [🔄 پردازش در پس‌زمینه با صف‌ها](#پردازش-در-پس‌زمینه-با-صف‌ها) - عملیات زمان‌بر رو به صف‌های کارآمد منتقل کن
- [📊 مانیتورینگ و پروفایلینگ](#مانیتورینگ-و-پروفایلینگ) - عملکرد برنامه رو زیر نظر بگیر و مشکلات رو شناسایی کن

### 🔒 امنیت
- [🛡️ بررسی امنیتی کد](#بررسی-امنیتی-کد) - آسیب‌پذیری‌های امنیتی رو شناسایی و برطرف کن
- [🔐 سیستم احراز هویت پیشرفته](#سیستم-احراز-هویت-پیشرفته) - مکانیزم‌های امن برای ورود و مدیریت کاربران پیاده‌سازی کن
- [🔑 سیستم مجوزدهی سفارشی](#سیستم-مجوزدهی-سفارشی) - کنترل دسترسی دقیق و انعطاف‌پذیر برای منابع برنامه بساز
- [🔒 محافظت از API](#محافظت-از-api) - API‌ها رو با تکنیک‌های پیشرفته امن کن

### 🔄 API و ارتباطات
- [📡 ساخت RESTful API حرفه‌ای](#ساخت-restful-api-حرفه‌ای) - API استاندارد با ساختار منظم و پاسخ‌های یکپارچه بساز
- [🔄 API Resource و تبدیل داده](#api-resource-و-تبدیل-داده) - داده‌ها رو با فرمت مناسب برای API آماده کن
- [📱 ادغام با سرویس‌های خارجی](#ادغام-با-سرویس‌های-خارجی) - ارتباط با API‌های شخص ثالث رو به شکل اصولی پیاده‌سازی کن
- [📊 مستندسازی API با Swagger](#مستندسازی-api-با-swagger) - مستندات خودکار و تعاملی برای API‌هات بساز

### 🚀 پرامپت‌های پیشرفته و ترکیبی
- [🔄 ریفکتور کامل پروژه قدیمی](#ریفکتور-کامل-پروژه-قدیمی) - پروژه‌های لاراول قدیمی رو به نسخه‌های جدید ارتقا بده
- [🏗️ ساخت پکیج لاراول](#ساخت-پکیج-لاراول) - پکیج‌های قابل استفاده مجدد برای انتشار عمومی بساز
- [🌐 پیاده‌سازی چندزبانگی پیشرفته](#پیاده‌سازی-چندزبانگی-پیشرفته) - سیستم چندزبانه کامل با مدیریت ترجمه‌ها پیاده‌سازی کن
- [📱 اپلیکیشن PWA با لاراول](#اپلیکیشن-pwa-با-لاراول) - وب اپلیکیشن پیشرفته با قابلیت‌های موبایل بساز

## پرامپت‌های تخصصی

### طراحی مدل با روابط مختلف

مدل‌های Eloquent  رو با روابط مختلف و ویژگی‌های پیشرفته بساز که کار رو هم برای کار با مدل ساده تر بکنیم.

**پرامپت:**

```
لطفاً یک مدل لاراول برای [موجودیت یا entity] با روابط زیر طراحی کن:

روابط مورد نیاز (اگر نیاز دارید):
1. رابطه [نوع رابطه] با [موجودیت دیگر]
2. رابطه [نوع رابطه دیگر] با [موجودیت سوم]
3. رابطه [نوع رابطه پیچیده] با [موجودیت چهارم]

ویژگی‌های مورد نیاز در مدل:
1. محافظت از فیلدهای حساس با $hidden و $guarded
2. اعتبارسنجی داده‌ها با قوانین مناسب
3. متدهای کمکی برای عملیات رایج روی این موجودیت
4. اسکوپ‌های مفید برای کوئری‌های پرکاربرد
5. accessor و mutator برای فیلدهای نیازمند پردازش
6. events و observer برای مدیریت چرخه حیات موجودیت
7. اگر فیلدی به نظرت قابلیت این رو داشت که اتوماتیک مقدار بگیره داخل boot قرارش بده
8. مواردی هم که نظرت جاش داخل مدل نیست ولی بودنش خوبه و به توسعه پذیری کمک میکنه رو در نهایت پیشنهاد بده

لطفاً کد کامل مدل رو همراه با توضیحات و بهترین شیوه‌های لاراول ارائه بده و برای هر بخش، دلیل استفاده و مزایای اون رو هم اخر سر توضیح بده.
```

### بهینه‌سازی کوئری‌های پیچیده

کوئری‌های سنگین و کند Eloquent رو به کوئری‌های سریع و بهینه تبدیل کن تا عملکرد برنامه‌ت بهبود پیدا کنه.

**پرامپت:**

```
این کوئری Eloquent رو بهینه‌سازی کن:

```php
[کد کوئری فعلی]
```

مشکلات احتمالی که باید برطرف بشن:
1. مشکل N+1 query و عدم استفاده مناسب از eager loading
2. انتخاب تمام ستون‌ها به جای ستون‌های مورد نیاز
3. عدم استفاده از ایندکس‌ها در where clause‌ها
4. استفاده ناکارآمد از collection methods به جای کوئری‌های دیتابیس
5. عدم استفاده از کش برای نتایج تکراری
6. نامناسب بودن ترتیب عملیات (مثلاً فیلتر کردن بعد از دریافت همه رکوردها)

لطفاً کوئری بهینه‌شده را با این ویژگی‌ها ارائه بده:
1. استفاده صحیح از eager loading برای روابط
2. انتخاب فقط ستون‌های مورد نیاز
3. استفاده از query builder به جای collection methods (در صورت امکان)
4. پیاده‌سازی استراتژی کش مناسب
5. استفاده از اسکوپ‌ها برای کوئری‌های تکراری

همچنین توضیح بده هر تغییر چه تأثیری بر عملکرد و مصرف منابع خواهد داشت.
```

### کنترلر RESTful استاندارد

کنترلرهای RESTful استاندارد و تمیز با رعایت بهترین شیوه‌های لاراول بساز که مدیریت منابع رو ساده‌تر می‌کنه.

**پرامپت:**

```
لطفاً یک کنترلر RESTful لاراول برای مدیریت منابع [نام منبع] با ویژگی‌های زیر بنویس:

ویژگی‌های منبع:
- [فیلد 1]: [توضیح و نوع داده]
- [فیلد 2]: [توضیح و نوع داده]
- [فیلد 3]: [توضیح و نوع داده]
- [روابط مهم با سایر منابع]

قابلیت‌های مورد نیاز:
1. لیست کردن منابع با:
    - صفحه‌بندی هوشمند
    - فیلترهای پیشرفته
    - مرتب‌سازی دلخواه
    - جستجو در چند فیلد

2. نمایش جزئیات منبع با:
    - بارگذاری روابط مورد نیاز
    - فرمت‌بندی مناسب خروجی

3. ایجاد منبع جدید با:
    - اعتبارسنجی کامل ورودی‌ها
    - مدیریت خطاهای اعتبارسنجی
    - ذخیره روابط مرتبط

4. ویرایش منبع با:
    - اعتبارسنجی جزئی فیلدهای ارسالی
    - به‌روزرسانی هوشمند فقط فیلدهای تغییریافته

5. حذف منبع با:
    - حذف نرم (soft delete)
    - مدیریت وابستگی‌ها

6. قابلیت‌های اضافی:
    - بازیابی موارد حذف‌شده
    - عملیات دسته‌جمعی
    - مدیریت مجوزهای دسترسی

لطفاً از بهترین شیوه‌های لاراول استفاده کن، از جمله:
- استفاده از Form Request برای اعتبارسنجی
- استفاده از Resource برای تبدیل داده‌ها
- استخراج منطق کسب‌وکار به سرویس‌ها
- مدیریت خطا و پاسخ‌های استاندارد API
- مستندسازی متدها با DocBlock

کد نهایی باید خوانا، قابل نگهداری و مطابق با استانداردهای PSR باشد.
```

### طراحی میگریشن بهینه

میگریشن‌های دقیق و کارآمد با ساختار مناسب برای دیتابیس بساز که عملکرد و یکپارچگی داده‌ها رو تضمین کنه.

**پرامپت:**

```
لطفاً میگریشن‌های لاراول برای سیستم [نام سیستم] با جداول و روابط زیر طراحی کن:

جدول 1: [نام جدول]
- فیلد 1: [نوع و توضیحات]
- فیلد 2: [نوع و توضیحات]
- رابطه با [جدول دیگر]: [نوع رابطه]

جدول 2: [نام جدول]
- فیلد 1: [نوع و توضیحات]
- فیلد 2: [نوع و توضیحات]
- رابطه با [جدول دیگر]: [نوع رابطه]

[سایر جداول...]

نیازمندی‌های خاص:
1. ایندکس‌های مناسب برای:
    - فیلدهای پرجستجو
    - کلیدهای خارجی
    - فیلدهای مورد استفاده در مرتب‌سازی

2. محدودیت‌های یکتایی برای:
    - [فیلدهای نیازمند یکتایی]
    - [ترکیب فیلدهای نیازمند یکتایی ترکیبی]

3. کلیدهای خارجی با:
    - استراتژی مناسب برای cascade/restrict/set null
    - نام‌گذاری استاندارد

4. بهینه‌سازی‌های خاص:
    - استفاده از انواع داده مناسب برای حجم داده
    - تنظیمات storage engine مناسب
    - استفاده از فیلدهای json برای داده‌های نیمه‌ساختاریافته

5. ویژگی‌های اضافی:
    - فیلدهای timestamp و soft delete
    - فیلدهای ردیابی تغییرات (created_by, updated_by)

لطفاً فایل‌های میگریشن را با رعایت ترتیب صحیح وابستگی‌ها ایجاد کن و برای هر میگریشن، متد down مناسب برای rollback هم در نظر بگیر.

همچنین برای هر تصمیم طراحی (مثل نوع فیلدها، ایندکس‌ها و محدودیت‌ها)، دلیل انتخاب و مزایای آن را توضیح بده.
```

### تست یونیت برای سرویس‌ها

تست‌های یونیت جامع برای سرویس‌های لاراول بنویس که از صحت عملکرد کدهات اطمینان حاصل کنی.

**پرامپت:**

```
لطفاً تست‌های یونیت جامع برای این سرویس لاراول بنویس:

```php
[کد سرویس]
```

موارد تست مورد نیاز:
1. تست happy path برای همه متدهای عمومی:
    - ورودی‌های معتبر
    - شرایط معمول اجرا
    - خروجی‌های مورد انتظار

2. تست شرایط خطا و استثناها:
    - ورودی‌های نامعتبر
    - شرایط خاص که باید استثنا پرتاب شود
    - مدیریت خطاهای داخلی

3. تست edge case‌ها:
    - مقادیر مرزی
    - لیست‌های خالی
    - مقادیر null و غیرمنتظره

4. تست با mock برای وابستگی‌های خارجی:
    - دیتابیس
    - سرویس‌های دیگر
    - API‌های خارجی
    - فایل‌سیستم

برای هر تست، این موارد را در نظر بگیر:
- استفاده از Arrange-Act-Assert pattern
- نام‌گذاری واضح و توصیفی
- جداسازی تست‌ها از یکدیگر
- استفاده از data providers برای تست سناریوهای مشابه
- استفاده از mock و stub مناسب برای ایزوله کردن تست‌ها

لطفاً از فریمورک تست لاراول و بهترین شیوه‌های تست‌نویسی استفاده کن و برای هر تست، توضیح کوتاهی درباره هدف و سناریوی آن ارائه بده.
```

### استراتژی کش جامع

سیستم کش کارآمد برای افزایش سرعت برنامه طراحی کن که زمان پاسخ‌گویی رو کاهش بده و بار سرور رو کم کنه.

**پرامپت:**

```
لطفاً یک استراتژی کش جامع برای این بخش از اپلیکیشن لاراول طراحی کن:

```php
[کد بخش مورد نظر]
```

نیازمندی‌های کش:
1. کش داده‌های پرکاربرد و کم‌تغییر:
    - [نوع داده‌های مورد نظر]
    - زمان انقضای مناسب
    - استراتژی به‌روزرسانی

2. کش نتایج کوئری‌های سنگین:
    - کوئری‌های پیچیده با زمان اجرای بالا
    - کوئری‌های با فراوانی اجرای زیاد
    - مدیریت پارامترهای متغیر در کوئری‌ها

3. کش بخش‌های HTML یا داده‌های خروجی:
    - کش کامل یا بخشی از صفحات
    - کش بر اساس نقش کاربر یا پارامترهای درخواست
    - استفاده از fragment caching

4. استراتژی invalidation کش:
    - تشخیص زمان نیاز به پاکسازی کش
    - به‌روزرسانی هوشمند به جای پاکسازی کامل
    - استفاده از tag و گروه‌بندی برای مدیریت بهتر

5. مدیریت race condition و همزمانی:
    - جلوگیری از cache stampede
    - مدیریت به‌روزرسانی همزمان
    - استراتژی lock یا semaphore

لطفاً کد پیاده‌سازی کش را با استفاده از امکانات لاراول (Redis/Memcached/File) ارائه بده و برای هر بخش، این موارد را توضیح بده:
- دلیل انتخاب روش کش
- زمان انقضای مناسب و چرایی آن
- کلیدهای کش و نحوه طراحی آنها
- استراتژی invalidation و به‌روزرسانی
- نحوه مدیریت خطاها و fallback در صورت مشکل در سیستم کش

همچنین یک نمودار یا توضیح گردش کار برای نشان دادن نحوه عملکرد سیستم کش در سناریوهای مختلف ارائه بده.
```

### بررسی امنیتی کد

آسیب‌پذیری‌های امنیتی در کد لاراول رو شناسایی و برطرف کن تا از داده‌ها و کاربران برنامه‌ت محافظت کنی.

**پرامپت:**

```
لطفاً این کد لاراول را از نظر امنیتی بررسی کن و آسیب‌پذیری‌های احتمالی را شناسایی و رفع کن:

```php
[کد مورد بررسی]
```

آسیب‌پذیری‌های احتمالی که باید بررسی شوند:

1. SQL Injection:
    - استفاده نادرست از query builder
    - کوئری‌های خام بدون پارامتربندی
    - استفاده نامناسب از whereRaw و مشابه آن

2. XSS (Cross-Site Scripting):
    - عدم escape کردن خروجی‌ها در blade
    - استفاده از {!! !!} بدون تمیزسازی داده‌ها
    - پاس دادن مستقیم داده‌های کاربر به JavaScript

3. CSRF (Cross-Site Request Forgery):
    - عدم استفاده از توکن CSRF در فرم‌ها
    - عدم محافظت از اندپوینت‌های حساس

4. Mass Assignment:
    - عدم محافظت از فیلدهای حساس در مدل‌ها
    - استفاده نادرست از create() یا update() بدون محدودیت

5. نشت اطلاعات حساس:
    - لاگ کردن اطلاعات محرمانه
    - ارسال اطلاعات حساس در پاسخ‌های API
    - عدم استفاده از $hidden در مدل‌ها

6. مشکلات احراز هویت و مجوزدهی:
    - عدم بررسی مجوزها قبل از انجام عملیات حساس
    - منطق نادرست در policy‌ها یا gate‌ها
    - امکان escalation مجوزها

7. آسیب‌پذیری‌های دیگر:
    - عدم اعتبارسنجی ورودی‌ها
    - مشکلات امنیتی در آپلود فایل
    - آسیب‌پذیری‌های مرتبط با جلسات و کوکی‌ها

لطفاً برای هر مشکل امنیتی یافت شده:
1. توضیح دهید چرا این کد آسیب‌پذیر است
2. سناریوی حمله احتمالی را شرح دهید
3. کد اصلاح شده و امن را ارائه دهید
4. توصیه‌های بیشتر برای پیشگیری از مشکلات مشابه در آینده ارائه کنید

در پایان، یک چک‌لیست امنیتی برای بررسی‌های مشابه در آینده ارائه دهید.
```

### ساخت RESTful API حرفه‌ای

API استاندارد با ساختار منظم و پاسخ‌های یکپارچه بساز که برای توسعه‌دهندگان فرانت‌اند و موبایل استفاده از آن آسان باشه.

**پرامپت:**

```
لطفاً یک RESTful API حرفه‌ای با لاراول برای مدیریت [منابع مورد نظر] با ویژگی‌های زیر طراحی و پیاده‌سازی کن:

منابع اصلی:
1. [منبع 1]: [توضیح مختصر و فیلدهای اصلی]
2. [منبع 2]: [توضیح مختصر و فیلدهای اصلی]
3. [روابط بین منابع]

ویژگی‌های مورد نیاز API:
1. معماری استاندارد RESTful:
    - نامگذاری منطقی endpoint‌ها
    - استفاده صحیح از متدهای HTTP
    - استفاده از کدهای وضعیت HTTP مناسب
    - پشتیبانی از HATEOAS برای ناوبری بهتر

2. احراز هویت و امنیت:
    - پیاده‌سازی با Laravel Sanctum/Passport
    - مدیریت توکن‌ها و انقضای آنها
    - محدودیت نرخ درخواست (Rate Limiting)
    - سطوح دسترسی مختلف برای کاربران متفاوت

3. مدیریت داده‌ها:
    - اعتبارسنجی دقیق ورودی‌ها
    - پاسخ‌های خطای استاندارد و معنادار
    - صفحه‌بندی نتایج با meta data کامل
    - فیلترینگ، مرتب‌سازی و جستجو در منابع
    - امکان انتخاب فیلدهای مورد نیاز (Sparse Fieldsets)
    - بارگذاری روابط به صورت انتخابی (Include)

4. بهینه‌سازی عملکرد:
    - استراتژی کش مناسب
    - بهینه‌سازی کوئری‌ها
    - کاهش تعداد درخواست‌ها با طراحی مناسب

5. ویژگی‌های پیشرفته:
    - نسخه‌بندی API
    - مستندسازی خودکار با OpenAPI/Swagger
    - پشتیبانی از CORS برای دسترسی cross-origin
    - پشتیبانی از فرمت‌های مختلف خروجی (JSON/XML)

لطفاً برای پیاده‌سازی این API:
1. کنترلرهای API مناسب بنویس
2. Resource/Transformer برای فرمت‌بندی پاسخ‌ها ایجاد کن
3. روت‌های API را با نامگذاری و گروه‌بندی مناسب تعریف کن
4. میدل‌ورهای مورد نیاز برای احراز هویت و امنیت پیاده‌سازی کن
5. مستندات کوتاه برای نحوه استفاده از API ارائه بده

همچنین نمونه‌ای از فرمت پاسخ‌های موفق و خطا را برای درک بهتر ساختار API ارائه بده.
```

### ریفکتور کامل پروژه قدیمی

پروژه‌های لاراول قدیمی رو به نسخه‌های جدید ارتقا بده و کدها رو با استانداردهای مدرن بازسازی کن.

**پرامپت:**

```
من یک پروژه لاراول قدیمی (نسخه [نسخه فعلی]) دارم که می‌خواهم به لاراول [نسخه جدید] ارتقا دهم و کد آن را مدرن‌سازی کنم. بخش‌های کلیدی پروژه:

```php
[نمونه‌هایی از کدهای قدیمی]
```

مشخصات پروژه فعلی:
- تعداد تقریبی مدل‌ها: [تعداد]
- تعداد تقریبی کنترلرها: [تعداد]
- نوع پروژه: [وب/API/هر دو]
- ویژگی‌های خاص: [ویژگی‌های خاص پروژه]
- وابستگی‌های اصلی: [پکیج‌های اصلی مورد استفاده]

مشکلات شناخته شده:
- [مشکل 1]
- [مشکل 2]
- [مشکل 3]

لطفاً یک استراتژی جامع برای ریفکتور و ارتقا ارائه بده که شامل موارد زیر باشد:

1. مراحل ارتقای تدریجی نسخه:
    - گام‌های میانی برای ارتقای امن
    - تغییرات اساسی در هر نسخه که باید در نظر گرفته شوند
    - نحوه حفظ عملکرد در طول فرآیند ارتقا

2. مدرن‌سازی ساختار پروژه:
    - ساختار پوشه‌بندی جدید پیشنهادی
    - جداسازی منطق کسب‌وکار از کنترلرها
    - پیاده‌سازی الگوهای طراحی مدرن (Repository, Service Layer, etc.)

3. بازنویسی بخش‌های کلیدی:
    - مدرن‌سازی مدل‌ها و استفاده از ویژگی‌های جدید Eloquent
    - بازنویسی کنترلرها با رویکرد Single Action Controllers یا Resource Controllers
    - ارتقای سیستم احراز هویت به روش‌های جدید
    - بهینه‌سازی کوئری‌ها و استفاده از eager loading

4. استراتژی تست:
    - نحوه نوشتن تست‌ها برای کد موجود
    - اطمینان از حفظ عملکرد در طول ریفکتور
    - پوشش تست برای ویژگی‌های حیاتی

5. بهینه‌سازی عملکرد و امنیت:
    - شناسایی و رفع مشکلات امنیتی
    - بهبود زمان پاسخ‌دهی و مصرف منابع
    - پیاده‌سازی کش و بهینه‌سازی دیتابیس

6. برنامه زمانی و اولویت‌بندی:
    - ترتیب پیشنهادی برای ریفکتور بخش‌های مختلف
    - تخمین زمان برای هر مرحله
    - نقاط بررسی برای اطمینان از پیشرفت صحیح

لطفاً برای هر بخش، نمونه کد و توضیحات کافی ارائه بده و دلایل تغییرات پیشنهادی را شرح بده. همچنین ریسک‌های احتمالی و نحوه مدیریت آنها را توضیح بده.
```

</div>

## Authors

- [@mohammadrasoulasghari](https://github.com/mohammadrasoulasghari)